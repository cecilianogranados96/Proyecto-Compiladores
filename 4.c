/*GRAFICO NO FUNCIONA*/
#define P(X)j=write(1,X,1)
#define C 39


int main(){

	int M[5000]={2},*u=M,N[5000],R=22;
	int a[4];
	int l[4];
	int m[4];
	int *b=N,*d=N,c,e,f,g,i,j,k,s;

	for(M[i=C*R-1]=24;f|d>=b;f++){
		m[0]=1;m[1]=-C;m[2]=-1;m[3]=C;
		l[0]=0;l[1]=-1;l[2]=C-1;l[3]=-1;
		c=M[g=i];
		i=e;
		for(s=f=0;s<4;s++){
			if((k=m[s]+g)>=0&&k<C*R&&l[s]!=k%C&&(!M[k]||!j&&c>=16!=M[k]>=16))a[f++]=s;
		}

		if(f){
			f=M[e=m[s=a[rand()/(1+2147483647/f)]]+g];
			j=j<f?f:j;f+=c&-16*!j;M[g]=c|1<<s;
			M[*d++=e]=f|1<<(s+2)%4;
		}else{
			e=d>b++?b[-1]:e;
		}
	}

for(;s=C;--s)
{
	P(4) ;
	P(8) ;
}
for(;e=C;e--)P(6) ;
	for(;e=C;e--){
		P(3+(*u++/8)%2) ;
		P(8+(*u/4)%2) ;}
		for(M[i=C*R-1]=24;f|d>=b;f++){
			m[0]=1;m[1]=-C;m[2]=-1;m[3]=C;
			l[0]=0;l[1]=-1;l[2]=C-1;l[3]=-1;
			c=M[g=i];
			i=e;
			for(s=f=0;s<4;s++){
				if((k=m[s]+g)>=0&&k<C*R&&l[s]!=k%C&&(!M[k]||!j&&c>=16!=M[k]>=16))a[f++]=s;
			}

			if(f){
				f=M[e=m[s=a[rand()/(1+2147483647/f)]]+g];
				j=j<f?f:j;f+=c&-16*!j;M[g]=c|1<<s;
				M[*d++=e]=f|1<<(s+2)%4;
			}else{
				e=d>b++?b[-1]:e;
			}
		}

	for(;s=C;--s)
	{
		P(4) ;
		P(8) ;
	}
	for(;e=C;e--)P(6) ;
		for(;e=C;e--){
			P(3+(*u++/8)%2) ;
			P(8+(*u/4)%2) ;}
			for(M[i=C*R-1]=24;f|d>=b;f++){
				m[0]=1;m[1]=-C;m[2]=-1;m[3]=C;
				l[0]=0;l[1]=-1;l[2]=C-1;l[3]=-1;
				c=M[g=i];
				i=e;
				for(s=f=0;s<4;s++){
					if((k=m[s]+g)>=0&&k<C*R&&l[s]!=k%C&&(!M[k]||!j&&c>=16!=M[k]>=16))a[f++]=s;
				}

				if(f){
					f=M[e=m[s=a[rand()/(1+2147483647/f)]]+g];
					j=j<f?f:j;f+=c&-16*!j;M[g]=c|1<<s;
					M[*d++=e]=f|1<<(s+2)%4;
				}else{
					e=d>b++?b[-1]:e;
				}
			}

		for(;s=C;--s)
		{
			P(4) ;
			P(8) ;
		}
		for(;e=C;e--)P(6) ;
			for(;e=C;e--){
				P(3+(*u++/8)%2) ;
				P(8+(*u/4)%2) ;}
				for(M[i=C*R-1]=24;f|d>=b;f++){
					m[0]=1;m[1]=-C;m[2]=-1;m[3]=C;
					l[0]=0;l[1]=-1;l[2]=C-1;l[3]=-1;
					c=M[g=i];
					i=e;
					for(s=f=0;s<4;s++){
						if((k=m[s]+g)>=0&&k<C*R&&l[s]!=k%C&&(!M[k]||!j&&c>=16!=M[k]>=16))a[f++]=s;
					}

					if(f){
						f=M[e=m[s=a[rand()/(1+2147483647/f)]]+g];
						j=j<f?f:j;f+=c&-16*!j;M[g]=c|1<<s;
						M[*d++=e]=f|1<<(s+2)%4;
					}else{
						e=d>b++?b[-1]:e;
					}
				}

			for(;s=C;--s)
			{
				P(4) ;
				P(8) ;
			}
			for(;e=C;e--)P(6) ;
				for(;e=C;e--){
					P(3+(*u++/8)%2) ;
					P(8+(*u/4)%2) ;}
					for(M[i=C*R-1]=24;f|d>=b;f++){
						m[0]=1;m[1]=-C;m[2]=-1;m[3]=C;
						l[0]=0;l[1]=-1;l[2]=C-1;l[3]=-1;
						c=M[g=i];
						i=e;
						for(s=f=0;s<4;s++){
							if((k=m[s]+g)>=0&&k<C*R&&l[s]!=k%C&&(!M[k]||!j&&c>=16!=M[k]>=16))a[f++]=s;
						}

						if(f){
							f=M[e=m[s=a[rand()/(1+2147483647/f)]]+g];
							j=j<f?f:j;f+=c&-16*!j;M[g]=c|1<<s;
							M[*d++=e]=f|1<<(s+2)%4;
						}else{
							e=d>b++?b[-1]:e;
						}
					}

				for(;s=C;--s)
				{
					P(4) ;
					P(8) ;
				}
				for(;e=C;e--)P(6) ;
					for(;e=C;e--){
						P(3+(*u++/8)%2) ;
						P(8+(*u/4)%2) ;}
						for(M[i=C*R-1]=24;f|d>=b;f++){
							m[0]=1;m[1]=-C;m[2]=-1;m[3]=C;
							l[0]=0;l[1]=-1;l[2]=C-1;l[3]=-1;
							c=M[g=i];
							i=e;
							for(s=f=0;s<4;s++){
								if((k=m[s]+g)>=0&&k<C*R&&l[s]!=k%C&&(!M[k]||!j&&c>=16!=M[k]>=16))a[f++]=s;
							}

							if(f){
								f=M[e=m[s=a[rand()/(1+2147483647/f)]]+g];
								j=j<f?f:j;f+=c&-16*!j;M[g]=c|1<<s;
								M[*d++=e]=f|1<<(s+2)%4;
							}else{
								e=d>b++?b[-1]:e;
							}
						}

					for(;s=C;--s)
					{
						P(4) ;
						P(8) ;
					}
					for(;e=C;e--)P(6) ;
						for(;e=C;e--){
							P(3+(*u++/8)%2) ;
							P(8+(*u/4)%2) ;}
							for(M[i=C*R-1]=24;f|d>=b;f++){
								m[0]=1;m[1]=-C;m[2]=-1;m[3]=C;
								l[0]=0;l[1]=-1;l[2]=C-1;l[3]=-1;
								c=M[g=i];
								i=e;
								for(s=f=0;s<4;s++){
									if((k=m[s]+g)>=0&&k<C*R&&l[s]!=k%C&&(!M[k]||!j&&c>=16!=M[k]>=16))a[f++]=s;
								}

								if(f){
									f=M[e=m[s=a[rand()/(1+2147483647/f)]]+g];
									j=j<f?f:j;f+=c&-16*!j;M[g]=c|1<<s;
									M[*d++=e]=f|1<<(s+2)%4;
								}else{
									e=d>b++?b[-1]:e;
								}
							}

						for(;s=C;--s)
						{
							P(4) ;
							P(8) ;
						}
						for(;e=C;e--)P(6) ;
							for(;e=C;e--){
								P(3+(*u++/8)%2) ;
								P(8+(*u/4)%2) ;}
								for(M[i=C*R-1]=24;f|d>=b;f++){
									m[0]=1;m[1]=-C;m[2]=-1;m[3]=C;
									l[0]=0;l[1]=-1;l[2]=C-1;l[3]=-1;
									c=M[g=i];
									i=e;
									for(s=f=0;s<4;s++){
										if((k=m[s]+g)>=0&&k<C*R&&l[s]!=k%C&&(!M[k]||!j&&c>=16!=M[k]>=16))a[f++]=s;
									}

									if(f){
										f=M[e=m[s=a[rand()/(1+2147483647/f)]]+g];
										j=j<f?f:j;f+=c&-16*!j;M[g]=c|1<<s;
										M[*d++=e]=f|1<<(s+2)%4;
									}else{
										e=d>b++?b[-1]:e;
									}
								}

							for(;s=C;--s)
							{
								P(4) ;
								P(8) ;
							}
							for(;e=C;e--)P(6) ;
								for(;e=C;e--){
									P(3+(*u++/8)%2) ;
									P(8+(*u/4)%2) ;}
									for(M[i=C*R-1]=24;f|d>=b;f++){
										m[0]=1;m[1]=-C;m[2]=-1;m[3]=C;
										l[0]=0;l[1]=-1;l[2]=C-1;l[3]=-1;
										c=M[g=i];
										i=e;
										for(s=f=0;s<4;s++){
											if((k=m[s]+g)>=0&&k<C*R&&l[s]!=k%C&&(!M[k]||!j&&c>=16!=M[k]>=16))a[f++]=s;
										}

										if(f){
											f=M[e=m[s=a[rand()/(1+2147483647/f)]]+g];
											j=j<f?f:j;f+=c&-16*!j;M[g]=c|1<<s;
											M[*d++=e]=f|1<<(s+2)%4;
										}else{
											e=d>b++?b[-1]:e;
										}
									}

								for(;s=C;--s)
								{
									P(4) ;
									P(8) ;
								}
								for(;e=C;e--)P(6) ;
									for(;e=C;e--){
										P(3+(*u++/8)%2) ;
										P(8+(*u/4)%2) ;}
										for(M[i=C*R-1]=24;f|d>=b;f++){
											m[0]=1;m[1]=-C;m[2]=-1;m[3]=C;
											l[0]=0;l[1]=-1;l[2]=C-1;l[3]=-1;
											c=M[g=i];
											i=e;
											for(s=f=0;s<4;s++){
												if((k=m[s]+g)>=0&&k<C*R&&l[s]!=k%C&&(!M[k]||!j&&c>=16!=M[k]>=16))a[f++]=s;
											}

											if(f){
												f=M[e=m[s=a[rand()/(1+2147483647/f)]]+g];
												j=j<f?f:j;f+=c&-16*!j;M[g]=c|1<<s;
												M[*d++=e]=f|1<<(s+2)%4;
											}else{
												e=d>b++?b[-1]:e;
											}
										}

									for(;s=C;--s)
									{
										P(4) ;
										P(8) ;
									}
									for(;e=C;e--)P(6) ;
										for(;e=C;e--){
											P(3+(*u++/8)%2) ;
											P(8+(*u/4)%2) ;}
											for(M[i=C*R-1]=24;f|d>=b;f++){
												m[0]=1;m[1]=-C;m[2]=-1;m[3]=C;
												l[0]=0;l[1]=-1;l[2]=C-1;l[3]=-1;
												c=M[g=i];
												i=e;
												for(s=f=0;s<4;s++){
													if((k=m[s]+g)>=0&&k<C*R&&l[s]!=k%C&&(!M[k]||!j&&c>=16!=M[k]>=16))a[f++]=s;
												}

												if(f){
													f=M[e=m[s=a[rand()/(1+2147483647/f)]]+g];
													j=j<f?f:j;f+=c&-16*!j;M[g]=c|1<<s;
													M[*d++=e]=f|1<<(s+2)%4;
												}else{
													e=d>b++?b[-1]:e;
												}
											}

										for(;s=C;--s)
										{
											P(4) ;
											P(8) ;
										}
										for(;e=C;e--)P(6) ;
											for(;e=C;e--){
												P(3+(*u++/8)%2) ;
												P(8+(*u/4)%2) ;}
												for(M[i=C*R-1]=24;f|d>=b;f++){
													m[0]=1;m[1]=-C;m[2]=-1;m[3]=C;
													l[0]=0;l[1]=-1;l[2]=C-1;l[3]=-1;
													c=M[g=i];
													i=e;
													for(s=f=0;s<4;s++){
														if((k=m[s]+g)>=0&&k<C*R&&l[s]!=k%C&&(!M[k]||!j&&c>=16!=M[k]>=16))a[f++]=s;
													}

													if(f){
														f=M[e=m[s=a[rand()/(1+2147483647/f)]]+g];
														j=j<f?f:j;f+=c&-16*!j;M[g]=c|1<<s;
														M[*d++=e]=f|1<<(s+2)%4;
													}else{
														e=d>b++?b[-1]:e;
													}
												}

											for(;s=C;--s)
											{
												P(4) ;
												P(8) ;
											}
											for(;e=C;e--)P(6) ;
												for(;e=C;e--){
													P(3+(*u++/8)%2) ;
													P(8+(*u/4)%2) ;}
													for(M[i=C*R-1]=24;f|d>=b;f++){
														m[0]=1;m[1]=-C;m[2]=-1;m[3]=C;
														l[0]=0;l[1]=-1;l[2]=C-1;l[3]=-1;
														c=M[g=i];
														i=e;
														for(s=f=0;s<4;s++){
															if((k=m[s]+g)>=0&&k<C*R&&l[s]!=k%C&&(!M[k]||!j&&c>=16!=M[k]>=16))a[f++]=s;
														}

														if(f){
															f=M[e=m[s=a[rand()/(1+2147483647/f)]]+g];
															j=j<f?f:j;f+=c&-16*!j;M[g]=c|1<<s;
															M[*d++=e]=f|1<<(s+2)%4;
														}else{
															e=d>b++?b[-1]:e;
														}
													}

												for(;s=C;--s)
												{
													P(4) ;
													P(8) ;
												}
												for(;e=C;e--)P(6) ;
													for(;e=C;e--){
														P(3+(*u++/8)%2) ;
														P(8+(*u/4)%2) ;}
														for(M[i=C*R-1]=24;f|d>=b;f++){
															m[0]=1;m[1]=-C;m[2]=-1;m[3]=C;
															l[0]=0;l[1]=-1;l[2]=C-1;l[3]=-1;
															c=M[g=i];
															i=e;
															for(s=f=0;s<4;s++){
																if((k=m[s]+g)>=0&&k<C*R&&l[s]!=k%C&&(!M[k]||!j&&c>=16!=M[k]>=16))a[f++]=s;
															}

															if(f){
																f=M[e=m[s=a[rand()/(1+2147483647/f)]]+g];
																j=j<f?f:j;f+=c&-16*!j;M[g]=c|1<<s;
																M[*d++=e]=f|1<<(s+2)%4;
															}else{
																e=d>b++?b[-1]:e;
															}
														}

													for(;s=C;--s)
													{
														P(4) ;
														P(8) ;
													}
													for(;e=C;e--)P(6) ;
														for(;e=C;e--){
															P(3+(*u++/8)%2) ;
															P(8+(*u/4)%2) ;}
															for(M[i=C*R-1]=24;f|d>=b;f++){
																m[0]=1;m[1]=-C;m[2]=-1;m[3]=C;
																l[0]=0;l[1]=-1;l[2]=C-1;l[3]=-1;
																c=M[g=i];
																i=e;
																for(s=f=0;s<4;s++){
																	if((k=m[s]+g)>=0&&k<C*R&&l[s]!=k%C&&(!M[k]||!j&&c>=16!=M[k]>=16))a[f++]=s;
																}

																if(f){
																	f=M[e=m[s=a[rand()/(1+2147483647/f)]]+g];
																	j=j<f?f:j;f+=c&-16*!j;M[g]=c|1<<s;
																	M[*d++=e]=f|1<<(s+2)%4;
																}else{
																	e=d>b++?b[-1]:e;
																}
															}

														for(;s=C;--s)
														{
															P(4) ;
															P(8) ;
														}
														for(;e=C;e--)P(6) ;
															for(;e=C;e--){
																P(3+(*u++/8)%2) ;
																P(8+(*u/4)%2) ;}
																for(M[i=C*R-1]=24;f|d>=b;f++){
																	m[0]=1;m[1]=-C;m[2]=-1;m[3]=C;
																	l[0]=0;l[1]=-1;l[2]=C-1;l[3]=-1;
																	c=M[g=i];
																	i=e;
																	for(s=f=0;s<4;s++){
																		if((k=m[s]+g)>=0&&k<C*R&&l[s]!=k%C&&(!M[k]||!j&&c>=16!=M[k]>=16))a[f++]=s;
																	}

																	if(f){
																		f=M[e=m[s=a[rand()/(1+2147483647/f)]]+g];
																		j=j<f?f:j;f+=c&-16*!j;M[g]=c|1<<s;
																		M[*d++=e]=f|1<<(s+2)%4;
																	}else{
																		e=d>b++?b[-1]:e;
																	}
																}

															for(;s=C;--s)
															{
																P(4) ;
																P(8) ;
															}
															for(;e=C;e--)P(6) ;
																for(;e=C;e--){
																	P(3+(*u++/8)%2) ;
																	P(8+(*u/4)%2) ;}
																	for(M[i=C*R-1]=24;f|d>=b;f++){
																		m[0]=1;m[1]=-C;m[2]=-1;m[3]=C;
																		l[0]=0;l[1]=-1;l[2]=C-1;l[3]=-1;
																		c=M[g=i];
																		i=e;
																		for(s=f=0;s<4;s++){
																			if((k=m[s]+g)>=0&&k<C*R&&l[s]!=k%C&&(!M[k]||!j&&c>=16!=M[k]>=16))a[f++]=s;
																		}

																		if(f){
																			f=M[e=m[s=a[rand()/(1+2147483647/f)]]+g];
																			j=j<f?f:j;f+=c&-16*!j;M[g]=c|1<<s;
																			M[*d++=e]=f|1<<(s+2)%4;
																		}else{
																			e=d>b++?b[-1]:e;
																		}
																	}

																for(;s=C;--s)
																{
																	P(4) ;
																	P(8) ;
																}
																for(;e=C;e--)P(6) ;
																	for(;e=C;e--){
																		P(3+(*u++/8)%2) ;
																		P(8+(*u/4)%2) ;}
																		for(M[i=C*R-1]=24;f|d>=b;f++){
																			m[0]=1;m[1]=-C;m[2]=-1;m[3]=C;
																			l[0]=0;l[1]=-1;l[2]=C-1;l[3]=-1;
																			c=M[g=i];
																			i=e;
																			for(s=f=0;s<4;s++){
																				if((k=m[s]+g)>=0&&k<C*R&&l[s]!=k%C&&(!M[k]||!j&&c>=16!=M[k]>=16))a[f++]=s;
																			}

																			if(f){
																				f=M[e=m[s=a[rand()/(1+2147483647/f)]]+g];
																				j=j<f?f:j;f+=c&-16*!j;M[g]=c|1<<s;
																				M[*d++=e]=f|1<<(s+2)%4;
																			}else{
																				e=d>b++?b[-1]:e;
																			}
																		}

																	for(;s=C;--s)
																	{
																		P(4) ;
																		P(8) ;
																	}
																	for(;e=C;e--)P(6) ;
																		for(;e=C;e--){
																			P(3+(*u++/8)%2) ;
																			P(8+(*u/4)%2) ;}
																			
}
